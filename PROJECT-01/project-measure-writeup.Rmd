---
output:
  pdf_document:
    keep_tex: true
    fig_caption: true
    toc: true
    toc_depth: 3 
    number_sections: true
    citation_package: natbib
    latex_engine: pdflatex
    template: ./../latex-templates/report.tex
    extra_dependencies: ["hyperref"]
  html_document:
    df_print: paged
    
title: "The Influence of Biological Sex on Human Body Part Ratios"
subtitle: "How these Ratios Compare Between the Sexes"
author: 
- name: "Kevin A. Black - kevin.black@wsu.edu"
  affiliation: "Washington State University Vancouver"
keywords: |
    multiple comparisons to control; multivariate chi-square distribution; nonlinear growth curves; Richard's curve; simulated critical points
abstract: |
  In this article we compare the \emph{empirical characteristic function} \citep{Tukey:1977, Becker:1988} to a \emph{moment-generating-functional form} to compute the proportion of hypotheses $m$ that are rejected under the null hypothesis. \vspace{0.25in}

  \noindent Here is a second paragraph of the abstract (if necessary), and with the pipe notation it doesn't break. Notice it still needs to be indented. \vspace{0.25in}

  \noindent Generally, we write this abstract last.  Often it is called the executive summary. It should succinctly summarize the entire document.  You can include references such as this one to the Appendices section \ref{sec:appendix} if necessary.
sectionnumberdepth: 3
titleEndnotes: "ENDNOTES"
titleReferences: "REFERENCES"
columnsReferences: 2
titleTOC:  "TABLE OF CONTENTS"
bibliography: ./../biblio/master.bib
bibliostyle: ./../biblio/ormsv080.bst
date: "`r format(Sys.time(), '%B %d, %Y')`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\section{Introduction}
\label{sec:intro}

As a customary portion of the STAT 419 course at Washington State University, the students involved were required to take part in a data collection/manipulation project involving the measurements of various body parts. Following the data collection, professor Monte Shaffer compiled all contributions made by the students into a single, pipe-delimited text file whose explicit content is to remain confidential and only used for the sake of addressing a variety of research questions.

\vspace{0.25cm}

After receiving the data set ($n=428$) and cleaning up particular observations using a range of methodologies based on what I had in mind for how this data will be used, I determined that I would focus on what kind of influence biological sex has on certain human body part ratios. To supplement my inquiry of this data, I centered my research questions around particular measurements of the human body, such as height, arm span, foot length, distance from elbow to armpit, head height, just to name a few. Research questions pertaining to this study and supportive R code can be found below.

\section{How does being male or female influence the ratios between certain body parts?}
\label{sec:rq}
Making particular deductions throughout history regarding body measurements among males and females is more than likely due to the distinct patterns one can find when comparing the biological sexes. Those born as males or females have about as many differing features to one another than their similar features, both internally and externally. Internally speaking, men typically have deeper voices, a faster metabolism, and can easily build muscle mass, whereas women possess a much more complicated reproductive system, have the ability to breastfeed, and live longer on average \citep{Wolchover:2011}. What about externally? How does being male or female influence the ratios between certain body parts? The latter primary question will be elaborated through the following sub-questions, focusing on particular ratios that are likely to yield some insight on the different external measurements between males and females.

\subsection{How does 'height' compare to 'arm span' between males and females?}
\label{sec:rq2}
Test

\begin{figure}[!ht]
	\begin{center}
	    \scalebox{1.00}{	\includegraphics[trim = 0 0 0 0,clip,width=0.85\textwidth]{figures/sq1.png} }
	    \caption{Plots and correlation values for males and females regarding height and arm span.}
	\end{center}
	\label{fig:sq1}
\end{figure}

\subsection{How does 'foot length' compare to the length of 'elbow to armpit' between males and females?}
\label{sec:rq3}


\subsection{How many average 'head height' lengths are males and females relative to their respective, average 'height'?}
\label{sec:rq4}


\section{Data Description}
\label{sec:data}

As mentioned in the introduction, the data set utilized throughout this research paper was supplied through the combined efforts of professor Monte Shaffer and the students of the STAT 419 class at Washington State University. Each student was tasked with recording distinct observations of 37 attributes from 10 different people, ideally with an even mix of males and females. For each observation (person), there are measurements of body parts, data collector/respondent identifiers ran through a MD5 hash function, and general information about each respondent. Body part measurements were recorded using body measuring tape in either inches or centimeters, but for the sake of consistency throughout the research paper, all centimeter values were converted to inches and will be treated as inches from here on.

\vspace{0.25cm}

These observations were recorded in early September 2020 and compiled by the instructor for our use in late October 2020. Given that these observations were recorded amid the COVID-19 pandemic, each student was required to make a simple, yet descriptive handout that would detail how one would go about recording their own body measurements and the necessary values to take note of. This would be an ideal situation of how observations were recorded and sent electronically by each respondent, but observations could also be taken in person given that the surveyor and respondent were comfortable being in close proximity of each other. An example of a two-page handout created by Kevin Black, as well as further information regarding the attributes of this data set, can be found in Appendix \ref{sec:appendix-data-handout} and Appendix \ref{sec:appendix-dataset-ex}, respectively.

\vspace{0.25cm}

On the surface, the purpose for writing this research paper and collecting the necessary data can simply be attributed to project requirements for a university course. However, the deeper reasoning behind why this research paper was composed the first place was to give students a more thorough understanding of the data analytics process. More specifically, how to not just work with the data, but how to understand the data and derive effective questions, how to test for patterns and conclusions in a statistical, analytic environment, and how to exercise data provenance practices. This process will be very similar between all data focused projects in a data analyst's career, so this is a good starting point for garnering crucial experience. 

\section{Key Findings}
\label{sec:findings}

\newpage

\section{APPENDICES}
\label{sec:appendix}

\subsection{Data Provenance}
\label{sec:appendix-data-provenance}

\subsubsection{Utilization of Data Provenance}
\label{sec:appendix-provenance-explained}

While it could be seen as an application mainly used in large-scale data analytics projects, the multitude of steps to practice data provenance was also used to handle the vulnerable data used in this research. Auxiliary files such as the R project files can be found on the \href{https://github.com/KevnBlack/WSU_STATS419_FALL2020/tree/master/PROJECT-01}{project repository} through GitHub, while the specific functions used in this report can be found in the `functions-project-measure.R` \href{https://raw.githubusercontent.com/KevnBlack/WSU_STATS419_FALL2020/master/functions/functions-project-measure.R}{file} or in section \ref{sec:appendix-setup}. The data set itself was not saved to any location online due to privacy concerns, but it was organized and saved onto a local hard drive for immediate use. 

\vspace{0.25cm}

The collection and general organization process for the data set is thoroughly described in sections \ref{sec:data} and \ref{sec:appendix-dataset-ex}. Cleaning for the actual substance of the data set was performed through the use of the `prepareMeasureData()` function, where the data set was manipulated to more better fit the aims of addressing the particular research questions for this report. Cleaning this data set involved multiple steps, such as: omitting rows containing NA values based solely on the body measurement columns, setting a consistent naming convention for gender and units, converting all body measurement values to inches, and scaling the body measurement data. Keeping the research questions in mind and despite the cleaning of all columns, the only body measurement fields utilized were $height$, $arm.span$, $foot.length$, $elbow.armpit$, and $head.height$.

\vspace{0.25cm}

Prior to `prepareMeasureData()`, the data is imported via the `read.file()` function where it checks to see if a cleaned version of the data set already exists, to which that particular file would take precedence and be used. If no clean version currently exists, the function goes through the cleaning process and saves the cleaned data set to the same directory as original data set. For unbiased samples of the data frame, a seed was set for reproducibility and 200 random observations were drawn without replacement.

\vspace{0.25cm}

The documented R code can be found in section \ref{sec:appendix-setup}. Key findings and visualizations of summary statistics were discussed previously throughout sections \ref{sec:rq} through \ref{sec:findings}. Based on the points made in this section, its clear that data provenance was kept in mind for making sure there was a traceable history in the usage of this data set, whether to resolve potential issues or to cut down on access times.

\newpage

\subsubsection{Data Collection Handout}
\label{sec:appendix-data-handout}

\begin{figure}[!ht]
	\hrule
	\caption{ \textbf{Handout Page 1} }
	\begin{center}
	    \scalebox{1.00}{	\includegraphics[trim = 0 0 0 0,clip,width=0.85\textwidth]{pdfs/handout1.pdf} }
	\end{center}
	\label{fig:handout-1}
	\hrule
\end{figure}

\newpage

\begin{figure}[!ht]
	\hrule
	\caption{ \textbf{Handout Page 2} }
	\begin{center}
	    \scalebox{1.00}{	\includegraphics[trim = 0 0 0 0,clip,width=0.85\textwidth]{pdfs/handout2.pdf} }
	\end{center}
	\label{fig:handout-2}
	\hrule
\end{figure}

\newpage

\subsection{Data Set Explained}
\label{sec:appendix-dataset-ex}
In addition to how the data set was described in Section \ref{sec:data}, explanations regarding each attribute can be found below. After the collaborative effort of all students having their data compiled, the data set ended up having 428 total observations. However, the data set was filled with an enormous amount of NA values in the body measurements, potentially due to the time constraints of some students or lack of attempt to fill out all fields. As a result, running the function `complete.cases()` on the data set during the data cleaning process returned a data frame containing only 262 observations, about 61.21% of the original data set size. `complete.cases()` was used over `na.omit()` because the latter function would omit all rows containing NA values based on all columns, including the rows where the non-body measurement attributes had NA values, whereas the former function would omit NA values only for the specified body measurement columns.

\begin{figure}[!ht]
	\caption{ \textbf{Description of Each Field} }
	\begin{center}
	    \scalebox{1.00}{	\includegraphics[trim = 0 350 100 35,clip,width=0.85\textwidth]{pdfs/datasets_explained.pdf} }
	\end{center}
	\label{fig:datasets_explained}
\end{figure}

\newpage

\subsection{R Code Used for Research}
\label{sec:appendix-setup}

Below are the necessary functions required to produce the figures and findings referenced in this report.
```{r,message=FALSE}
prepareMeasureData = function(measure){
  # Cleaning: omit NA rows based measured values, not on $side
  measure = measure[complete.cases(measure[,4:26]),]
  
  # Cleaning: consistent naming convention
  measure$gender = factor(tolower(measure$gender))
  measure$gender[measure$gender=="f"] = "female"
  measure$gender[measure$gender=="m"] = "male"
  measure$units = factor(tolower(measure$units))
  measure$units[measure$units=="inches"] = "in"
  measure$units[measure$units=="inch"] = "in"
  measure$units[measure$units=="\"in\""] = "in"
  measure$units[measure$units=="cm"] = "in"
  
  # Converting cm to inches
  for(row in 1:nrow(measure)){
    if(measure[row,]$units=="cm"){
      measure[row,4:26] <- measure[row,4:26]/2.54
    }
  }
  
  # Scale data
  measure[,4:26] <- scale(measure[,4:26])
  
  return(measure)
}

read.file = function(path){
  tryCatch(
    expr = {
      # Open cleaned file if already available
      measure = utils::read.csv(paste0(path.to.secret,"measure-clean.txt"),
                                header = TRUE, quote = "", sep = "|")
      return(measure)
    },
    warning = function(w){
      # If no clean file, open original file
      measure = utils::read.csv(paste0(path.to.secret,"measure-students.txt"),
                                header = TRUE, quote = "", sep = "|")
      # Clean data
      measure = prepareMeasureData(measure)
      
      # Save cleaned data for later
      write.table(measure,paste0(path.to.secret,"measure-clean.txt"),sep="|",quote=FALSE)
      return(measure)
    }
  )    
}
```

Below are the libraries and R code used to source functions, import measurement data, and perform analysis on said data.
```{r,fig.show="hide",message=FALSE}
# Import necessary libraries
library(stats) # For cor()
library(devtools) # For source_url()

# Source cleaning function
path.hub = "https://raw.githubusercontent.com/KevnBlack/WSU_STATS419_FALL2020/"
source_url(paste0(path.hub,"master/functions/functions-project-measure.R"))
path.to.secret = "D:/School/Fall 2020/STAT 419/datasets/"
measure.df = read.file(path.to.secret) # Import data
set.seed(1) # Sample 200 observations from data frame
measure.sample = measure.df[sample(nrow(measure.df),200),]

# Isolate male and female data
measure.df.m = measure.sample[measure.sample$gender == "male",]
measure.df.f = measure.sample[measure.sample$gender == "female",]
cor.m = cor(measure.df.m$height.NA, measure.df.m$arm.span.NA)
cor.f = cor(measure.df.f$height.NA, measure.df.f$arm.span.NA)

# Sub-question 1
## Trend lines for plots
lm.m = lm(measure.df.m$height.NA ~ measure.df.m$arm.span.NA)
lm.f = lm(measure.df.f$height.NA ~ measure.df.f$arm.span.NA)

## Correlation Graphs
par(mfrow = c(1,2))
plot(measure.df.m$height.NA, measure.df.m$arm.span.NA,
     main = paste("Correlation =", round(cor.m,5)), pch = 4,
     xlab = "Male Height (in)", ylab = "Male Arm Span (in)", col = "blue")
abline(lm.m)

plot(measure.df.f$height.NA, measure.df.f$arm.span.NA,
     main = paste("Correlation =", round(cor.f,5)), pch = 0,
     xlab = "Female Height (in)", ylab = "Female Arm Span (in)", col = "red")
abline(lm.f)

# Sub-question 2

# Sub-question 3
```






